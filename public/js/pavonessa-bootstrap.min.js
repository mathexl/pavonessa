define("routes",[],function(){function e(e,t){function n(e,t,n,r,i){return e.get(i.apihandle+"college.php?_cid="+r.current.params.cid).then(function(e){return e.data})}function r(e,t,n,r){return e.get(r.apihandle+"authjs.php").then(function(r){return user=r.data,t.user=r.data,user.accountsetup<1&&n.path("/set-account"),r.data},function(t){return!1})}e.when("/",{templateUrl:"public/views/dashboard.php",resolve:{user:r}}).when("/dashboard/",{templateUrl:"public/views/dashboard.php",controller:"dashboardController",resolve:{user:r}}).when("/dibs/",{templateUrl:"public/views/dibs.php",resolve:{user:r}}).when("/dibs/:i",{templateUrl:"public/views/dibs.php",resolve:{user:r}}).when("/feedback/",{templateUrl:"public/views/feedback.php",controller:"feedbackController",resolve:{user:r}}).when("/schools/",{templateUrl:"public/views/myschools.php",controller:"cprofileController",resolve:{user:r,college:n}}).when("/schools/:cid",{templateUrl:"public/views/college.php",controller:"cprofileController",resolve:{user:r,college:n}}).when("/schools/:cid/:tab",{templateUrl:"public/views/college.php",controller:"cprofileController",resolve:{user:r,college:n}}).when("/bookvisit/:cid/:fromdate~:todate",{templateUrl:"public/views/bookvisit.php",controller:"cprofileController",resolve:{user:r,college:n}}).when("/profile/",{templateUrl:"public/views/profile.php",resolve:{user:r},controller:"profileController"}).when("/profile/:uid",{templateUrl:"public/views/profile.php",resolve:{user:r},controller:"profileController"}).when("/profile/:uid/:tab",{templateUrl:"public/views/profile.php",resolve:{user:r}}).when("/create/:id",{redirectTo:"/set-account",resolve:{user:r}}).when("/pool/",{templateUrl:"public/views/pool.php",resolve:{user:r}}).when("/pool/:i",{templateUrl:"public/views/pool.php",resolve:{user:r}}).when("/money",{templateUrl:"public/views/money.php",controller:"moneyController",resolve:{user:r}}).when("/colleges/",{templateUrl:"public/views/colleges.php",resolve:{user:r}}).when("/hosts/",{templateUrl:"public/views/hosts.php",resolve:{user:r},controller:"hostsController"}).when("/hosts/:cid",{templateUrl:"public/views/hosts.php",resolve:{user:r},controller:"hostsController"}).when("/set-account",{templateUrl:"public/views/set-account.php",controller:"setAccountController",resolve:{user:r}}).when("/set-account/:i/",{templateUrl:"public/views/set-account.php",controller:"setAccountController",resolve:{user:r}}).when("/set-account/:i/{:formdata}",{templateUrl:"public/views/set-account.php",controller:"setAccountController",resolve:{user:r}}).when("/logout/",{template:'<script>document.location="'+t.projectdir+'?pageid=logout"</script>',resolve:{user:r}}).when("/login/",{controller:function(e,t){t.path("/dashboard")},template:" ",resolve:{user:r}}).otherwise({redirectTo:"/dashboard",resolve:{user:r}})}return e}),function(e,t){define("formdataConfig",[],function(){return function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var t=function(e){var n="",r,i,s,o,u,a,f;for(r in e){i=e[r];if(i instanceof Array)for(f=0;f<i.length;++f)u=i[f],s=r+"["+f+"]",a={},a[s]=u,n+=t(a)+"&";else if(i instanceof Object)for(o in i)u=i[o],s=r+"["+o+"]",a={},a[s]=u,n+=t(a)+"&";else i!==undefined&&i!==null&&(n+=encodeURIComponent(r)+"="+encodeURIComponent(i)+"&")}return n.length?n.substr(0,n.length-1):n};e.defaults.transformRequest=[function(e){return angular.isObject(e)&&String(e)!=="[object File]"?t(e):e}]}})}(window,document),function(e,t){define("directives/upIcon",[],function(){return function(){return{restrict:"E",scope:{iconid:"@iconid",size:"@size"},template:"<span style='font-size:{{size}};' class='icon icon-{{iconid}}'></span>"}}})}(),function(e,t){define("directives/tar",[],function(){return function(e,t){return{restrict:"A",scope:{reload:"=?",tar:"@"},link:function(n,r,i){$("body").scrollTop(0),n.reload||r.bind("click",function(){e.path("/"+n.tar,n.reload),t.$apply()})}}}})}(),function(e,t){define("directives/file",[],function(){return function(e){return{restrict:"AE",scope:{file:"@"},link:function(e,t,n){t.bind("change",function(t){var n=t.target.files,r=n[0];e.file=r,e.$parent.file=r,console.log("file"),e.$apply()})}}}})}(),function(e,t){define("directives/sticky",[],function(){return function(e,t){return{restrict:"A",scope:{upIf:"=?",upScope:"@",upOffset:"="},link:function(e,t,n){e.stickied=!1,console.log("stickied"),$(t).before('<div id="up-before" up-scope="'+e.upScope+'" style="position:static"></div>'),e.$on("upScroll",function(n,r){e.stickied==0&&r.scrollTop+e.upOffset>$(t).offset().top?($(t).css("height",$(t).height()).addClass("sticky"),$("#up-before[up-scope='"+e.upScope+"'").css("height",$(t).height()),e.stickied=!0):r.scrollTop+e.upOffset<$("#up-before[up-scope='"+e.upScope+"']").offset().top&&e.stickied==1&&($(t).removeClass("sticky"),$("#up-before[up-scope='"+e.upScope+"'").css("height",0),e.stickied=!1)})}}}})}(),function(e,t){define("directives/collegelist/widget",[],function(){return function(e,t){return{restrict:"E",scope:{offset:"=",limit:"=",src:"@src"},link:function(e,t,n){},controller:function(e,n){e.collegelist=[],e.init=function(){console.log(t.apihandle+e.src+"?cname&offset="+e.offset+"&limit="+e.limit),n.get(t.apihandle+e.src+"?offset="+e.offset+"&limit="+e.limit).then(function(t){t.data.status>0||(e.collegelist=t.data,console.log(t.data))})}},templateUrl:"public/js/directives/collegelist/widget.html"}}})}(),function(e,t){define("directives/taggableinput/widget",[],function(){return function(e,t){return{restrict:"E",scope:{data:"=ngModel",upResource:"=?",upStrict:"=?",upFilter:"=?",upMatchfilter:"=?"},link:function(e,t,n){t.bind("keydown",function(t){console.log(t.which);switch(t.which){case 188:case 13:case 32:e.$broadcast("upNextItem");break;case 8:e.$broadcast("upBkspc");break;case 40:e.$broadcast("upDown");break;case 38:e.$broadcast("upUp");break;default:}}),e.input="",e.data=e.data?e.data:[],e.index=0,e.originalInput="",e.suggestions=[],e.filter=function(t){return e.upFilter(t,e.input)}},controller:function(n){n.$watch("input",function(e,t){console.log(e==t),e!=t&&n.runFilter()}),n.searchTask=null,n.runFilter=function(){n.index=-1,n.suggestions=[],n.searchTask&&clearTimeout(n.searchTask),n.searchTask=setTimeout(function(){e.get(t.apihandle+"resource.php?q="+n.input).then(function(e){console.log(e.data),n.suggestions=e.data})},100)},n.$on("upNextItem",function(){n.input.length>0&&(n.upStrict?n.suggestions.indexOf(n.input)>-1:!0)?(n.data.push({text:n.input.name}),n.input="",n.originalInput="",n.$apply()):n.index!=-1&&(n.input=n.suggestions[n.index],n.data.push({text:n.input.name}),n.input="",n.originalInput="",n.$apply())}),n.$on("upDown",function(){n.upResource.data&&(n.index+1==n.suggestions.length?n.input=n.originalInput:(n.input!=""&&(n.originalInput=n.input),n.index=n.index<n.suggestions.length?n.index+1:-1),n.$apply())}),n.$on("upUp",function(){console.log(n.index),n.upResource.data&&(n.index==-1?(console.log("hi"),n.input=n.originalInput):(n.input!=""&&(n.originalInput=n.input),n.index=n.index>0?n.index-1:-1),n.$apply())}),n.$on("upBkspc",function(){n.input==""&&n.data.length>0&&(n.input=n.data.pop().text,n.$apply())})},templateUrl:"public/js/directives/taggableinput/widget.html"}}})}(),function(e,t){define("directives/hosts/widget",[],function(){return function(e,t){return{restrict:"E",scope:{limit:"@limit",src:"@src",school:"=",offset:"="},controller:function(e,n,r){e.hosts=[],e.init=function(){console.log(t.apihandle+e.src+"&_cid="+e.school+"&offset="+e.offset+"&limit="+e.limit),n.get(t.apihandle+e.src+"?_cid="+e.school+"&offset="+e.offset+"&limit="+e.limit).then(function(t){t.data.status>0?alert(t.data.details):e.hosts=t.data})},e.$watch("school",function(t){e.init()})},templateUrl:"public/js/directives/hosts/widget.html"}}})}(),function(e,t){define("directives/collegesearch/widget",[],function(){return function(e,t,n){var r={};return{restrict:"E",scope:{selectedCollegeId:"=?ngModel",next:"@"},link:function(t,r,i){t.visible=0,t.placeholder=i.placeholder?i.placeholder:"Search colleges....",t.offset=0,t.searchablecolleges=[],t.load=function(){e.get(n.apihandle+"college.php?offset=0&limit=100").then(function(e){e.data.status>0?alert(e.data.details):(t.searchablecolleges=t.searchablecolleges.concat(e.data),console.log(e.data))})},$(r).on("keydown",function(e){switch(e.which){case 40:t.visible=1,t.$broadcast("keyNav",{which:e.which});break;case 38:t.visible=1,t.$broadcast("keyNav",{which:e.which});break;case 13:t.visible=0,t.$broadcast("select"),e.stopPropagation(),e.preventDefault();break;default:t.visible=1,t.$broadcast("query")}}),$("body, elem").click(function(e){t.visible=0}),t.load()},controller:function(e,n){e.query="",e.searchcolleges=[],e.sindex=0,e.scollege={},e.searchTimer=null,e.search=function(){e.searchcolleges=e.searchablecolleges.filter(function(t,n){return t.cname.match(new RegExp("(.*"+e.query+".*)","i"))||t.citystate.match(new RegExp(".*"+e.query+".*","i"))})},e.select=function(n){e.sindex>-1&&(e.query=e.searchcolleges[n].cname,e.scollege=e.searchcolleges[n],e.selectedCollegeId=e.searchcolleges[n]._cid,e.next=="redir"&&(t.path("schools/"+e.selectedCollegeId),e.$apply())),e.visible=0,e.$apply()},e.$on("query",function(t){e.searchTimer&&clearTimeout(e.searchTimer),e.searchTimer=setTimeout(function(){console.log(e.query),e.query.length>2?e.search():e.query.length==0&&(e.searchcolleges=[],e.visible=0),e.$apply()},50)}),e.$on("keyNav",function(t,n){switch(event.which){case 40:e.sindex++,e.sindex%=e.searchcolleges.length;break;case 38:e.sindex--,e.sindex=e.sindex<0?e.searchcolleges.length:e.sindex}e.$apply()}),e.$on("select",function(t){e.select(e.sindex)})},templateUrl:"public/js/directives/collegesearch/widget-redir.html"}}})}(),function(e,t){define("directives/feed/upFeed",[],function(){return function(e,n,r,i,s){return{restrict:"E",scope:{cname:"=",feedid:"=",userid:"=?"},link:function(e,t,n){e.feed=[],e.loadFeed=function(t,n,r){s.getFeed(t).then(function(t){angular.forEach(t,function(t,i){var s=t,o=s.text.match(/#([a-zA-Z0-9]+)/g);s.tags=[],angular.forEach(o,function(e,t){switch(e){case"#academic":case"#academics":s.tags.push({color:"#ff6652",icon:"academics",text:e});break;case"#social":s.tags.push({color:"#52aefb",icon:"social",text:e});break;case"extracurricular":s.tags.push({color:"#2ecc7a",icon:"ec",text:e});break;default:s.tags.push({color:"#000",text:e})}}),s.children=[],s.depth=r,n.push(s),e.loadFeed(t._feedid,s.children,r+1),console.log(r)})})},e.loadFeed(e.feedid,e.feed,0)},controller:function(e,n,r,s){function o(){e.autoExpand("TextArea")}e.autoExpand=function(e){var n=typeof e=="object"?e.target:t.getElementById(e),r=n.scrollHeight-60;n.style.height=r+"px"},e.data={},e.submit=function(){s.postFeed(e.feedid,e.data.text).then(function(t){e.feed.unshift(t),e.data.text=""})},e.upvote=function(){n.post(i.apihandle+"vote.php",{_parentfid:e.feedid,value:1}).then(function(e){console.log(e)})}},templateUrl:"public/js/directives/feed/widget.html"}}})}(),function(e,t){define("directives/feed/upFeedItem",[],function(){return function(e,t){return{restrict:"E",replace:!0,scope:{member:"=",parent:"=",feedid:"@",userid:"@"},link:function(t,n,r){angular.isArray(t.member.children)&&(n.append(),e("<up:feedcollection collection='member.children'></up:feedcollection>")(t,function(e,t){n.append(e)}))},controller:function(e,n,r,i){e.reply=0,e.data={},e.submit=function(){i.postFeed(e.member._feedid,e.data.text).then(function(t){e.member.children.unshift(t),e.text="",e.reply=0})},e.delete=function(){n.delete(t.apihandle+"feed.php?_feedid="+e.member._feedid).then(function(t){e.member.deleted=!0})},e.upvote=function(){n.post(t.apihandle+"vote.php",{_feedid:e.member._feedid,value:1}).then(function(t){console.log(t),t.data.status!=1&&(e.member.points++,e.member.favorited=1)})}},templateUrl:"public/js/directives/feed/item.html"}}})}(),function(e,t){define("directives/feed/upFeedCollection",[],function(){return function(e,t,n){return{restrict:"E",replace:!0,scope:{collection:"=",feedid:"@",userid:"@"},template:"<ul class='feed'><up:feeditem feedid='{{feedid}}' userid='{{userid}}' ng-repeat='member in collection track by $index' member='member' parent='collection'></up:feeditem></ul>"}}})}(),function(e,t){define("directives/photostream/widget",[],function(){return function(e){return{restrict:"E",scope:{cid:"=?",id:"=?",upCol:"=",cname:"=",usercollege:"=",upload:"@"},controller:function(t,n,r){t.user=r.user,t.s3OptionsUri="core/model/photos/s3_access.php?bucket=pavonessa-photos",t.data={},t.cid&&(n.get(e.apihandle+"photofeed.php?_cid="+t.cid).then(function(r){t.photoStream=r.data,console.log(t.photoStream),t.photoModel=new Array(Math.max(1,t.upCol)),angular.forEach(t.photoStream,function(r,i){Array.isArray(t.photoModel[i%t.upCol])||(t.photoModel[i%t.upCol]=[]),t.photoModel[i%t.upCol].push(r),r.delete=function(){n.delete(e.apihandle+"photos.php?photoid="+r._photoid).then(function(e){console.log(e.data)})}}),console.log(t.photoModel)}),t.$watch("data.upload",function(){console.log(t.data.upload),t.data.upload&&n.post(e.apihandle+"photos.php",{photourl:t.data.upload})})),t.id&&n.get(e.apihandle+"photofeed.php?_id="+t.id).then(function(r){t.photoStream=r.data,console.log(r.data),t.photoModel=new Array(t.upCol),angular.forEach(t.photoStream,function(r,i){Array.isArray(t.photoModel[i%t.upCol])&&(t.photoModel[i%t.upCol]=new Array),t.photoModel[i%t.upCol].push(r),r.delete=function(){n.delete(e.apihandle+"photos.php?photoid="+r._photoid)}})})},templateUrl:"public/js/directives/photostream/widget.html"}}})}(),function(e,t){define("directives/timeselector/widget",[],function(){return function(e){return{restrict:"E",scope:{model:"=ngModel",host:"=?host",disabled:"=?disabled",todate:"=",fromdate:"="},link:function(e,t,n){e.isDragging=!1,e.mouseDown=!1,e.wasDragging=!1,$(t).on("mousedown",function(t){n.host?e.$broadcast("up-click",{mouseX:t.pageX,mouseY:t.pageY}):(e.wasDragging=!1,e.isDragging=!1,e.mouseDown=!0,e.$broadcast("up-dragstart",{startX:t.pageX,startY:t.pageY}))}),$(t).on("mousemove",function(t){n.host||(e.mouseDown&&e.$broadcast("up-dragmove",{currX:t.pageX,currY:t.pageY}),e.$broadcast("up-mousemove",{currX:t.pageX,currY:t.pageY}))}),$(t).on("mouseup",function(t){n.host||(e.wasDragging=!0,e.isDragging=!1,e.mouseDown=!1,e.$broadcast("up-dragstop",{stopX:t.pageX,stopY:t.pageY}))}),n.host||(e.rectangleSelect=function(e,t,n,r,i){var s=[];return $(e).each(function(){var e=$(this).offset(),o=e.left,u=e.top,a=$(this).width(),f=$(this).height();o>=t-a&&u>=n-f&&o<=r&&u<=i&&s.push($(this).get(0))}),s})},controller:function(e){e.$watch("todate + fromdate",function(){var t=864e5,n=new Date(e.fromdate),r=new Date(e.todate),i=Math.round((n.getTime()-r.getTime())/t);e.availtimes=[];if(i<=0)for(var s=0;s<=Math.abs(i);s++){var o={hrs:[0,0,0,0,0,0,0,0,0,0,0,0],day:n.mmdd(),fullDate:n.yyyymmdd()};e.availtimes.push(o),n.setDate(n.getDate()+1)}e.model=e.availtimes}),e.timeselected=function(){if(e.availtimes.length){var t=[];for(var n=0;n<e.availtimes.length;n++)t=t.concat(e.availtimes[n].hrs);var r=t.reduce(function(e,t,n){return e+t});return r}return 0},e.$on("up-dragstart",function(t,n){e.startX=n.startX,e.startY=n.startY}),e.$on("up-mousemove",function(t,n){e.mouseX=n.currX,e.mouseY=n.currY}),e.$on("up-dragmove",function(t,n){var r=e.rectangleSelect(".timeselector li.selectable",Math.min(e.startX,n.currX),Math.min(e.startY,n.currY),Math.max(e.startX,n.currX),Math.max(e.startY,n.currY));$(".timeselector li.selectable").each(function(){$(this).removeClass("selecting")}),$.each(r,function(e,t){$(t).addClass("selecting")})}),e.$on("up-dragstop",function(t,n){var r=e.rectangleSelect(".timeselector li.selectable",Math.min(e.startX,n.stopX),Math.min(e.startY,n.stopY),Math.max(e.startX,n.stopX),Math.max(e.startY,n.stopY));$.each(r,function(t,n){$(n).removeClass("selecting"),e.model[$(n).attr("up-day")].hrs[$(n).attr("up-hr")]++,e.model[$(n).attr("up-day")].hrs[$(n).attr("up-hr")]%=2}),e.model.timeselected=e.timeselected()}),e.$on("up-click",function(n,r){e.disabled||($v=$(".timeselector li.selected"),$v[0]&&(e.model[$v.attr("up-day")].hrs[$v.attr("up-hr")]=1),$v2=$(t.elementFromPoint(r.mouseX,r.mouseY)).hasClass("selectable")?$(t.elementFromPoint(r.mouseX,r.mouseY)):!1,$v2&&(e.model[$v2.attr("up-day")].hrs[$v2.attr("up-hr")]=2),e.$apply(),e.model.timeselected=e.timeselected())})},templateUrl:"public/js/directives/timeselector/widget.html"}}})}(),function(e,t){define("directives/datepicker/widget",[],function(){return function(e){return{restrict:"E",scope:{selectedDay:"=ngModel",limit:"@?",fromDate:"=fromdate","default":"=?"},link:function(e,t,n){e.showCal=!1,e.view="month",console.log(e.limit),$("body").click(function(n){console.log($(n.target).closest("#upSelectedDate")),$(n.target).closest(t).length?$(n.target).closest("#upSelectedDate").length&&(e.showCal=1):e.showCal=0,e.$apply()})},controller:function(e){var t=e.default?new Date(e.default):new Date;console.log(e.default,t),e.selectedDay=new Date(t.toDateString()),e.viewDay=new Date(t.toDateString()),e.currDay=new Date(t.toDateString()),e.fromdate=new Date(e.fromDate),e.fromDate&&(e.toDate=new Date(e.fromDate),e.toDate.setDate(e.toDate.getDate()+e.limit)),e.days=["Su","Mo","Tu","We","Th","Fr","Sa"],e.months=["January","February","March","April","May","June","July","August","September","October","November","December"],e.loadView=function(){var t=new Date(e.viewDay);t.setDate(0),t.setDate(t.getDate()-t.getDay());var n=new Date(e.viewDay.getFullYear(),e.viewDay.getMonth()+1,0);n.setDate(n.getDate()+(6-n.getDay()));var r=864e5,i=Math.floor((n-t)/r)+1;e.viewModel=[];for(var s=0;s<Math.ceil(i/7);s++){e.viewModel.push([]);for(var o=0;o<7;o++)e.viewModel[s].push({date:new Date(t),selectable:parseInt(e.limit)>0?t>e.fromdate&&t<e.todate:t>=e.currDay}),t.setDate(t.getDate()+1)}},e.nextMonth=function(){e.viewDay.setMonth(e.viewDay.getMonth()+1),e.viewDay.setDate(1),e.loadView()},e.prevMonth=function(){e.viewDay.setMonth(e.viewDay.getMonth()-1),e.viewDay.setDate(1),e.loadView()},e.select=function(t){e.showCal=0,e.selectedDay=t,console.log(e.$parent.todate,e.selectedDay),e.viewDay=t,e.loadView()},e.loadView(),e.$watch("fromDate",function(){e.limit&&(e.todate=new Date(e.fromDate),e.fromdate=new Date(e.fromDate),e.viewDay=new Date(e.fromDate),e.todate.setDate(e.todate.getDate()+parseInt(e.limit)),e.loadView())})},templateUrl:"public/js/directives/datepicker/widget.html"}}})}(),function(e,t){define("directives/upcoming/widget",[],function(){return function(e,t){return{restrict:"E",scope:{},link:function(e,t,n){},controller:function(e,n,r){e.events=[],n.get(t.apihandle+"upcoming.php").then(function(t){t.data.status>0||(e.events=t.data)})},templateUrl:"public/js/directives/upcoming/widget.html"}}})}(),function(e,t){define("directives/dibswidget/widget",[],function(){return function(e,t,n){return{restrict:"E",scope:{title:"@",icon:"@",src:"@"},link:function(e,n,r){var i=t.user.user_type;console.log(i)},controller:function(e,t){t.get(n.apihandle+e.src).then(function(r){r.data.status>0||(e.dibs=r.data,angular.forEach(e.dibs,function(r,i){r.availtimes=JSON.parse(e.dibs[i].availtimes);var s=864e5,o=new Date(e.dibs[i].fromtime),u=new Date(e.dibs[i].totime),a=Math.round(Math.abs((o.getTime()-u.getTime())/s));for(var f=0;f<=a;f++)o.setDate(o.getDate()+1),e.dibs[i].availtimes[f].day=o.yyyymmdd();r.delete=function(){console.log(n.apihandle+"pool.php?_did="+r._did),e.dibs.splice(i),t.delete(n.apihandle+"pool.php?_did="+r._did)},console.log(r)}))})},templateUrl:"public/js/directives/dibswidget/widget.html"}}})}(),function(e,t){define("directives/stripe/payments",[],function(){return function(e,t,n){return{restrict:"E",scope:{data:"="},link:function(e,t,n){},templateUrl:"public/js/directives/stripe/payments.html"}}})}(),function(e,t){define("directives/textform/widget",[],function(){return function(e){return{restrict:"E",scope:{upFormModel:"=",upFormSubmit:"=",title:"@"},link:function(e,t,n){t.bind("keydown",function(n){console.log(n.which);switch(n.which){case 39:case 13:e.$emit("upNextItem",{elem:t});break;case 37:e.$emit("upPrevItem",{elem:t});break;case 8:e.$emit("upBkspc",{elem:t});break;case 40:e.$emit("upDown",{elem:t});break;case 38:e.$emit("upUp",{elem:t});break;default:}})},controller:function(e,t){e.index=0,e.citem=e.upFormModel[0],e.s3OptionsUri="core/model/photos/s3_access.php?bucket=pavonessa-photos",e.$on("upNextItem",function(t,n){e.index++,e.citem=e.upFormModel[e.index],console.log(e.index+"|"+e.upFormModel.length),e.index==e.upFormModel.length?e.upFormSubmit():(e.init(e.upFormModel[e.index]),e.$apply())}),e.init=function(n){switch(n.type){case"timeselector":break;case"textarea":case"text":t(function(){$("[name='up-"+e.upFormModel[e.index].fieldname+"']")[0].focus()},0)}},e.$on("upPrevItem",function(){Math.max(0,--e.index),e.$apply()})},templateUrl:"public/js/directives/textform/widget.html"}}})}(),function(e,t){define("directives/tags/widget",[],function(){return function(e){return{restrict:"E",scope:{data:"="},link:function(e,t,n){},templateUrl:"public/js/directives/tags/tags.html"}}})}(),function(e,t){define("directives/profile/ratings",[],function(){return function(e){return{restrict:"E",scope:{data:"@",num:"@"},link:function(e,t,n){e.stars=[],console.log(e.data),e.$watch("data",function(){e.stars=[];for(var t=1;t<=5;t++)t<=e.data?e.stars.push(1):e.data-t==-.5?e.stars.push(2):e.stars.push(0)}),console.log(e.stars)},templateUrl:"public/js/directives/profile/ratings.html"}}})}(),function(e,t){define("directives/stripe/connect",[],function(){return function(e){return{restrict:"E",scope:{data:"="},link:function(e,t,n){},controller:function(e,t){e.user=t.user},templateUrl:"public/js/directives/stripe/connect.html"}}})}(),function(e,t){define("directives/profile/badges/widget",[],function(){return function(e){return{restrict:"E",scope:{data:"="},link:function(e,t,n){},templateUrl:"public/js/directives/profile/badges/widget.html"}}})}(),function(e,t){define("directives",["directives/upIcon","directives/tar","directives/file","directives/sticky","directives/collegelist/widget","directives/taggableinput/widget","directives/hosts/widget","directives/collegesearch/widget","directives/feed/upFeed","directives/feed/upFeedItem","directives/feed/upFeedCollection","directives/photostream/widget","directives/timeselector/widget","directives/datepicker/widget","directives/upcoming/widget","directives/dibswidget/widget","directives/stripe/payments","directives/textform/widget","directives/tags/widget","directives/profile/ratings","directives/stripe/connect","directives/profile/badges/widget","jquery","angular"],function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){angular.module("pavonessa.directives",["ngSanitize","ngRoute","pavonessa.services"]).constant("config",{apihandle:"//"+e.location.host+"/core/controllers/",projectdir:"//"+e.location.host+"/"}).directive("upIcon",t).directive("tar",n).directive("file",r).directive("sticky",i).directive("upTaggableinput",o).directive("upCollegelist",s).directive("upHosts",u).directive("upCollegesearch",a).directive("upFeed",f).directive("upFeedcollection",c).directive("upFeeditem",l).directive("upPhotostream",h).directive("upTimeselector",p).directive("upDatepicker",d).directive("upUpcoming",v).directive("upDibswidget",m).directive("upPayments",g).directive("upTextform",y).directive("upTags",b).directive("upRating",w).directive("upStripeconnect",E).directive("upProfileachievements",S)})}(window,document),function(e,t){define("controllers/cprofileCtrl",[],function(){var e=function(e,t,n,r,i,s,o,u,a){e.college=o[0],e.mode=t.tab?t.tab:"hosts",e.formdata={tags:[]},a.getCollegeList(0,4,1).then(function(t){e.othercolleges=t}),e.$watch("todate + fromdate",function(){e.preload()}),e.init=function(){e.fromdate=t.fromdate,e.todate=t.todate,e.preload()},e.currentProjectUrl=i.trustAsResourceUrl(e.college.map),e.tagFilter=function(e,t){return e.name.match(new RegExp(".*"+t+".*","i"))},e.strictFilter=function(e,t){return e.name.match(new RegExp(t,"i"))},e.preload=function(){e.formmodel=[{type:"timeselector",fieldname:"time",prompt:"Select your availability:",todate:e.todate,fromdate:e.fromdate,placeholder:""},{type:"text",fieldname:"birthday",prompt:"Birthday:",placeholder:"mm/dd/yyyy"},{type:"text",fieldname:"gradyear",prompt:"Graduation Year:",placeholder:""},{type:"text",fieldname:"major",prompt:"Major:",placeholder:""},{type:"photo",fieldname:"propic",prompt:"Profile Picture:",placeholder:""}]},e.book=function(t,n){e.todate=t,e.fromdate=n},e.favorite=function(){a.favoriteCollege(t.cid).then(function(t){e.college.favorited=t.data.status})},e.formSubmit=u.user_type=="host"?function(){e.formdata={propic:e.formmodel[4].data,major:e.formmodel[3].data,yearid:e.formmodel[2].data,bday:e.formmodel[1].data},e.formdata.fromdate=(new Date(e.fromdate)).yyyymmdd()+" 10:00",e.formdata.todate=(new Date(e.todate)).yyyymmdd()+" 10:00",e.formdata._cid=e.college._cid,e.formdata._pid=u._id,e.formdata.availtimes=JSON.stringify(e.availtimes),e.formdata.tags=JSON.stringify(e.tags),a.bookVisit(e.formdata).then(function(t){t.data.status===1?alert(t.data.details):r.url("schools/"+e.college._cid)})}:function(){}};return e})}(window,document),function(e,t){define("controllers/dibCtrl",[],function(){return function(t,n,r,i,s,o,u){t.dibs=[],t.sdib=null,t.formdata={_cid:0,prefs:"details",ptimes:"blubblubblub"},t.sealdata={},t.select=function(e){t.sindex=e,t.sdib=t.dibs[e],t.sdib.tags=t.dibs[e].tags instanceof String?JSON.parse(t.dibs[e].tags):[],s.path("dibs/"+t.sindex,!1)},t.seal=function(e){a.open({name:"pavonessa",description:"Book meeting with "+t.sindex.fname+" "+t.sindex.lname,amount:2e3})},$(e).on("popstate",function(){a.close()});var a=StripeCheckout.configure({key:"pk_test_bcaqKgvf4xC910OBJoT35NZP",image:"public/assets/images/stripe-img.png",token:function(e){n.post(o.apihandle+"seal.php",{_did:t.sdib._did,_pid:t.sdib._pid,_rid:t.sdib._rid,_hid:t.sdib._hid,date:t.sdib.selectedtime,stripeToken:e.id}).then(function(e){e.data.status===6&&alert(e.data.details)})}});t.init=function(){n.get(o.apihandle+"pool.php").then(function(e){e.data.status>0||(t.dibs=e.data,angular.forEach(t.dibs,function(e,r){e.availtimes=JSON.parse(t.dibs[r].availtimes);var i=864e5,s=new Date(t.dibs[r].fromtime),u=new Date(t.dibs[r].totime),a=Math.round(Math.abs((s.getTime()-u.getTime())/i));for(var f=0;f<=a;f++)s.setDate(s.getDate()+1),t.dibs[r].availtimes[f].day=s.yyyymmdd();e.delete=function(){n.delete(o.apihandle+"pool.php?_did="+e._did).then(function(e){e.data&&t.pool.splice(r)})}}),t.select(i.i?i.i:0))})},u.user_type=="host"?s.path("pool"):t.init()}})}(window,document),function(e,t){define("controllers/poolCtrl",[],function(){return function(e,t,n,r,i,s,o){e.pool=[],e.sprospie=null,e.formdata={},e.events=[],e.sindex=0,e.edit=!1,e.delete=!1,e.select=function(t){e.sprospie=null,e.sprospie=e.pool[t],e.sindex=t,i.path("pool/"+e.sindex,!1)},e.dib=function(n){var r,i;for(var o=0;o<e.sprospie.availtimes.length;o++)if(e.sprospie.availtimes[o].hrs.indexOf(2)>0){i=o,r=e.sprospie.availtimes[o].hrs.indexOf(2)+7;break}t.post(s.apihandle+"pool.php",{_rid:e.sprospie._rid,selectedtime:e.sprospie.availtimes[i].fullDate+" "+r+":00:00 ",hmessage:e.sprospie.hmessage}).then(function(t){t.data.status===1?alert(t.data.details):e.sprospie.readonly=!0})},o.user_type=="prospie"?i.path("dibs"):t.get(s.apihandle+"pool.php?_cid="+o._cid).then(function(n){n.data.status>0?alert(n.data.details):(e.pool=n.data,angular.forEach(e.pool,function(e,n){e.availtimes=JSON.parse(e.availtimes),e.tags=e.tags?JSON.parse(e.tags):"";if(e.selectedtime){var r=new Date(e.selectedtime),i=new Date(e.fromtime);e.availtimes[Math.floor((r-i)/864e5)].hrs[r.getHours()-7]=2,e.availtimes.com}e.delete=function(){t.delete(s.apihandle+"pool.php?_did="+e._did).then(function(e){e.data})}}),e.select(r.i>-1?r.i:0))})}})}(window,document),function(e,t){define("controllers/setAccountCtrl",[],function(){return function(e,t,n,r,i,s,o){e.page=r.i?parseInt(r.i):0,o.accountsetup>0&&i.path("/dashboard"),e.formmodel=o.user_type=="host"?[{type:"text",fieldname:"gradyear",prompt:"Graduation Year:",placeholder:""},{type:"text",fieldname:"major",prompt:"Major:",placeholder:""},{type:"textarea",fieldname:"bio",prompt:"One Sentence to Describe You:",placeholder:""},{type:"text",fieldname:"birthday",prompt:"Birthday:",placeholder:"mm/dd/yyyy"},{type:"photo",fieldname:"propic",prompt:"Profile Picture:",placeholder:""}]:[{type:"text",prompt:"Name:",placeholder:""},{type:"text",prompt:"Name:",placeholder:""},{type:"text",prompt:"Name:",placeholder:""},{type:"text",prompt:"Name:",placeholder:""},{type:"text",prompt:"Name:",placeholder:""}],e.formSubmit=o.user_type=="host"?function(){e.formdata={bio:e.formmodel[2].data,propic:e.formmodel[4].data,major:e.formmodel[1].data,yearid:e.formmodel[0].data,bday:e.formmodel[3].data},t.post(s.apihandle+"profile.php",e.formdata).then(function(e){console.log(e.data),e.data._id&&location.reload()})}:function(){},e.resource={load:function(){t.get(s.apihandle+"resource.php?os="+this.data.length).then(function(e){this.data.concat(e.data)})},data:[]},e.tagFilter=function(e,t){return e.match(new RegExp(".*"+t+".*","i"))},e.submit=function(){t.post(s.apihandle+"profile.php",e.formdata).then(function(e){location.reload()})}}})}(window,document),function(e,t){define("controllers/mainCtrl",[],function(){return function(e,t,n,r,i,s,o){console.log(n.user),n.serviceManager={services:[],startService:function(e,t,n){var r=this.services.length+1;n&&n();var i=setInterval(e,t);return this.services.push({id:r,process:i}),r},killService:function(e){clearInterval(this.services[e].process),delete this.services[e]}},e.$watch("$window.innerWidth",function(e){e<670?n.$displayview="mobile":e<900?n.$displayview="tablet":n.$displayview="desktop"}),e.notifPopups=[],e.notifs=[],e.showNotifDropdown=0,n.serviceManager.startService(function(){t.get(o.apihandle+"notifications.php?time="+(new Date((new Date).getTime()-5e3)).toISOString().slice(0,19).replace("T"," ")).then(function(t){while(t.data[0]&&e.notifs[0]._notifid!=t.data[0]._notifid)e.notifs.unshift(t.data[0]),e.$notify(t.data[0]),t.data.shift()})},5e3,function(){t.get(o.apihandle+"notifications.php").then(function(t){e.notifs=t.data})}),e.$notify=function(t){e.notifPopups.push(t),i(function(){e.notifPopups.shift()},1e4)},e.$watch("notifPopups",function(e){})}})}(window,document),function(e,t){define("controllers/navCtrl",[],function(){var e=function(e,t,n,r){e.matcher=!1,e.showsearchbar=0,e.path=t.path(),e.showprofiledropdown=0,e.$on("locationChanged",function(t,n){e.path=n.data[0]}),e.hideprofile=function(t){e.showprofiledropdown=0,t.stopPropagation()},e.toggleprofile=function(t){e.showprofiledropdown=(e.showprofiledropdown+1)%2,t.stopPropagation()},e.select=function(){e.path=t.path()},e.showsearch=function(t){e.showsearchbar=(e.showsearchbar+1)%2},e.matcherq=function(t){e.matcher=!0,console.log(e.matcher)},e.moneyerq=function(t){e.moneyer=!0}};return e})}(window,document),function(e,t){define("controllers/profileCtrl",[],function(){return function(e,t,n,r,i){e.upload="",e.data={},e.mode=n.tab?n.tab:"about",t.get(r.apihandle+"profile.php?_id="+n.uid).then(function(i){e.data={type:i.data.user_type,achievements:i.data.achievements?JSON.parse(i.data.achievements):[],fname:i.data.fname,lname:i.data.lname,bio:i.data.bio,propic:i.data.propic,coverpic:i.data.coverpic,major:i.data.major,yearid:i.data.yearid,_cid:i.data._cid,reviews:[],tags:i.data.tags?JSON.parse(i.data.tags):[],cname:i.data.cname,num_rating:i.data.num_rating,rating:i.data.rating,_id:i.data._id},console.log(i.data),t.get(r.apihandle+"otherhosts.php?_cid="+i.data._cid+"&offset=0&limit=4").then(function(t){e.otherhosts=t.data}),e.data.coverpic==null&&(e.data.coverpic=i.data.collegecoverpic),e.bio=!1,e.bioedit=function(){e.bio===!0?e.bio=!1:e.bio=!0},e.editbio=function(){t.post(r.apihandle+"editbio.php",e.formdata).then(function(t){e.data.bio=e.formdata.bio})},e.formdata.bio=e.data.bio,t.get(r.apihandle+"reviews.php?_hid="+n.uid).then(function(t){e.data.reviews=t.data})}),e.submit=function(){t.post(r.apihandle+"profile.php").then(function(e){})},e.formdata={}}})}(window,document),function(e,t){define("controllers/hostsCtrl",[],function(){return function(e,t,n,r,i,s){e._cid=r.cid,t.get(s.apihandle+"college.php?_cid="+e._cid).then(function(t){e.cname=t.data[0][1]})}})}(),function(e,t){define("controllers/moneyCtrl",[],function(){return function(e,t,n,r,i,s){t.post(s.apihandle+"stripeconnect.php",{scope:n.search().scope,code:n.search().code}).then(function(e){})}})}(window,document),function(e,t){define("controllers/dashCtrl",[],function(){var e=function(e,t,n,r,i,s,o){e.setup="feed"};return e})}(),function(e,t){define("controllers",["controllers/cprofileCtrl","controllers/dibCtrl","controllers/poolCtrl","controllers/setAccountCtrl","controllers/mainCtrl","controllers/navCtrl","controllers/profileCtrl","controllers/hostsCtrl","controllers/moneyCtrl","controllers/dashCtrl","jquery","angular"],function(e,t,n,r,i,s,o,u,a,f){angular.module("pavonessa.controllers",["ngRoute","pavonessa.services"]).controller("cprofileController",e).controller("dibsController",t).controller("mainCtrl",i).controller("navController",s).controller("poolController",n).controller("setAccountController",r).controller("profileController",o).controller("hostsController",u).controller("moneyController",a).controller("dashboardController",f)})}(),function(e,t){define("ng-s3upload",["jquery","angular"],function(){angular.module("ngS3upload.config",[]).value("ngS3upload.config",{debug:!0}).config(["$compileProvider",function(e){angular.isDefined(e.urlSanitizationWhitelist)?e.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/):e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),angular.module("ngS3upload.directives",[]),angular.module("ngS3upload",["ngS3upload.config","ngS3upload.directives","ngS3upload.services","ngSanitize"]),angular.module("ngS3upload.config",[]).constant("ngS3Config",{theme:"bootstrap2"}),angular.module("ngS3upload.services",[]).service("S3Uploader",["$http","$q","$window",function(e,t,n){this.uploads=0;var r=this;this.getUploadOptions=function(n){var r=t.defer();return e.get(n).success(function(e,t){r.resolve(e)}).error(function(e,t){r.reject(e)}),r.promise},this.randomString=function(e){var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n="";for(var r=e;r>0;--r)n+=t[Math.round(Math.random()*(t.length-1))];return n+(new Date).getTime()},this.upload=function(e,n,i,s,o,u,a,f,l){function d(t){e.$apply(function(){t.lengthComputable?e.progress=Math.round(t.loaded*100/t.total):e.progress="unable to compute";var n={type:"progress",value:e.progress};e.$emit("s3upload:progress",n),typeof c.notify=="function"&&c.notify(n)})}function v(t){var s=t.srcElement||t.target;e.$apply(function(){r.uploads--,e.uploading=!1,s.status===204?(e.success=!0,c.resolve(s),e.$emit("s3upload:success",s,{path:n+i})):(e.success=!1,c.reject(s),e.$emit("s3upload:error",s))})}function m(t){var n=t.srcElement||t.target;e.$apply(function(){r.uploads--,e.uploading=!1,e.success=!1,c.reject(n),e.$emit("s3upload:error",n)})}function g(t){var n=t.srcElement||t.target;e.$apply(function(){r.uploads--,e.uploading=!1,e.success=!1,c.reject(n),e.$emit("s3upload:abort",n)})}var c=t.defer();e.attempt=!0;var h=new FormData;h.append("key",i),h.append("acl",s),h.append("Content-Type",l.type),h.append("AWSAccessKeyId",u),h.append("policy",a),h.append("signature",f),h.append("file",l);var p=new XMLHttpRequest;return p.upload.addEventListener("progress",d,!1),p.addEventListener("load",v,!1),p.addEventListener("error",m,!1),p.addEventListener("abort",g,!1),e.$emit("s3upload:start",p),e.uploading=!0,this.uploads++,p.open("POST",n,!0),p.send(h),c.promise},this.isUploading=function(){return this.uploads>0}}]),angular.module("ngS3upload.directives",[]).directive("s3Upload",["$parse","S3Uploader","ngS3Config",function(e,t,n){return{restrict:"AC",require:"?ngModel",replace:!1,transclude:!0,scope:!0,controller:["$scope","$element","$attrs","$transclude",function(e,t,n,r){e.attempt=!1,e.success=!1,e.uploading=!1,e.barClass=function(){return{"bar-success":e.attempt&&!e.uploading&&e.success}}}],compile:function(e,n,r){return{pre:function(e,t,n){e.text=n.text;if(angular.isUndefined(n.bucket))throw Error("bucket is a mandatory attribute")},post:function(e,n,r,i){var s=angular.extend({},e.$eval(r.s3UploadOptions||r.options));s=angular.extend({submitOnChange:!0,getOptionsUri:"/getS3Options",acl:"public-read",uploadingKey:"uploading",folder:"",enableValidation:!0,targetFilename:null},s);var o=e.$eval(r.bucket),u=angular.element(n.children().children()[0]),a=angular.element(n.find("input")[0]);u.bind("click",function(e){a[0].click()}),i.$render=function(){e.filename=i.$viewValue};var f=function(){var n=a[0].files[0],r=n.name,u=r.split(".").pop();t.getUploadOptions(s.getOptionsUri).then(function(r){s.enableValidation&&i.$setValidity("uploading",!1);var a="https://"+o+".s3.amazonaws.com/",f=s.targetFilename?e.$eval(s.targetFilename):s.folder+(new Date).getTime()+"-"+t.randomString(16)+"."+u;t.upload(e,a,f,s.acl,n.type,r.key,r.policy,r.signature,n).then(function(){i.$setViewValue(a+f),e.filename=i.$viewValue,s.enableValidation&&(i.$setValidity("uploading",!0),i.$setValidity("succeeded",!0))},function(){e.filename=i.$viewValue,s.enableValidation&&(i.$setValidity("uploading",!0),i.$setValidity("succeeded",!1))})},function(e){throw Error("Can't receive the needed options for S3 "+e)})};n.bind("change",function(t){s.submitOnChange?e.$apply(function(){f()}):e.$apply(function(){var e=a[0].files[0],t=new FileReader;t.onloadend=function(e){angular.element("img",n).attr("src",t.result)},t.readAsDataURL(e)})}),angular.isDefined(r.doUpload)&&e.$watch(r.doUpload,function(e){e&&f()})}}},templateUrl:"public/directives/fileuploader/fileupload.html"}}])})}(window,document),function(e,t){define("services/api",[],function(){return function(e,t,n,r){return{getCollegeList:function(n,i,s){var o=t.defer();return e.get(r.apihandle+"college.php?offset={{ofst}}&limit={{lim}}&rand={{rand}}".replace("{{ofst}}",n).replace("{{lim}}",i).replace("{{rand}}",s)).then(function(t){o.resolve(t.data)}),o.promise},getProfile:function(n){var i=t.defer();return e.get(r.apihandle+"profile.php?_id={{id}}".replace("{{id}}",n)).then(function(t){i.resolve(t.data)}),i.promise},feed:{getFeed:function(n){var i=t.defer();return e.get(r.apihandle+"feed.php?_parentfid={{parentfid}}".replace("{{parentfid}}",n)).then(function(t){i.resolve(t.data)}),i.promise},postFeed:function(n,i){var s=t.defer();return e.post(r.apihandle+"feed.php",{_parentfid:n,text:i}).then(function(t){s.resolve(t.data)},function(t){s.reject(t)}),s.promise}},bookVisit:function(n){var i=t.defer();return e.post(r.apihandle+"pool.php").then(function(t){i.resolve(t.data)}),i.promise},favoriteCollege:function(n){var i=t.defer();return e.post(r.apihandle+"favorite.php",{_cid:$scope.college._cid}).then(function(t){i.resolve(t.data)}),i.promise}}}})}(),function(e,t){define("services",["services/api","jquery","angular"],function(t){angular.module("pavonessa.services",[]).constant("config",{apihandle:"//"+e.location.host+"/core/controllers/",projectdir:"//"+e.location.host+"/"}).factory("api",t)})}(window),function(e,t){require.config({baseUrl:"public/js/",paths:{jquery:["//code.jquery.com/jquery-latest.min"],angular:["//ajax.googleapis.com/ajax/libs/angularjs/1.3.16/angular.min"],"angular-routes":["//ajax.googleapis.com/ajax/libs/angularjs/1.2.5/angular-route.min"],"angular-sanitize":["//ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular-sanitize"],stripe:["https://checkout.stripe.com/checkout"]},shim:{angular:["jquery"],"angular-routes":["angular","angular-sanitize"],"angular-sanitize":["angular"]}}),require(["routes","formdataConfig","angular","jquery","angular-sanitize","angular-routes","directives","controllers","ng-s3upload","services"],function(n,r){var i={apihandle:"//"+t.location.host+"/core/controllers/",projectdir:"//"+t.location.host+"/"};Date.prototype.yyyymmdd=function(){var e=this.getFullYear().toString(),t=(this.getMonth()+1).toString(),n=this.getDate().toString();return e+"-"+(t[1]?t:"0"+t[0])+"-"+(n[1]?n:"0"+n[0])},Date.prototype.mmdd=function(){var e=(this.getMonth()+1).toString(),t=this.getDate().toString();return(e[1]?e:"0"+e[0])+"/"+(t[1]?t:"0"+t[0])},String.prototype.hash=function(){var e=this,t=0,n,r,i;if(e.length==0)return t;for(n=0,i=e.length;n<i;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;return t},angular.module("pavonessa",["ngRoute","pavonessa.directives","pavonessa.controllers","pavonessa.services"]).constant("config",i).config(n).config(r),angular.bootstrap(e,["pavonessa"])})}(document,window),define("pavonessa-bootstrap",function(){});